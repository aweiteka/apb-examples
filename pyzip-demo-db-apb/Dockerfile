FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"bmFtZTogcHl6aXAtZGVtby1kYi1hcGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9weXpp\
cC1kZW1vLWRiLWFwYgpkZXNjcmlwdGlvbjogUHl0aG9uIFppcCBEZW1vIERhdGFiYXNlIEFQQiBJ\
bXBsZW1lbnRhdGlvbgpiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6IAog\
IGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vZ2l0aHViLmNvbS9mdXNvci9hcGItZXhhbXBsZXMv\
dHJlZS9tYXN0ZXIvcHl6aXAtZGVtby1kYi1hcGIKICBkZXBlbmRlbmNpZXM6IFsnZG9ja2VyLmlv\
L2ZhYmlhbnZmL3Bvc3RncmVzcWw6cG9zdGdpcyddCiAgZGlzcGxheU5hbWU6IFB5emlwIERlbW8g\
RGF0YWJhc2UgKEFQQikKICBsb25nRGVzY3JpcHRpb246IEEgZGF0YWJhc2Ugd2l0aCBHSVMgc3Vw\
cG9ydCBhbmQgc2VlZGVkIGRhdGEgZm9yIGEgZGVtb25zdHJhdGlvbiBweXRob24gd2ViYXBwLCBo\
dHRwczovL2dpdGh1Yi5jb20vZnVzb3IvcHktemlwLWRlbW8KcGxhbnM6CiAgLSBuYW1lOiBkZWZh\
dWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYSBEQiB0byBiZSB1c2VkIHdp\
dGggdGhlIHB5emlwLWRlbW8gQVBCCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAg\
ZGlzcGxheU5hbWU6IERlZmF1bHQKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6CiAg\
ICAgIC0gbmFtZTogZGF0YWJhc2VfbmFtZQogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIE5hbWUKICAgICAgICByZXF1aXJl\
ZDogVHJ1ZQogICAgICAtIG5hbWU6IGRhdGFiYXNlX3Bhc3N3b3JkCiAgICAgICAgZGVmYXVsdDog\
YWRtaW4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZXNjcmlwdGlvbjogQSByYW5kb20g\
YWxwaGFudW1lcmljIHN0cmluZyBpZiBsZWZ0IGJsYW5rCiAgICAgICAgdGl0bGU6IERhdGFiYXNl\
IFBhc3N3b3JkCiAgICAgIC0gbmFtZTogZGF0YWJhc2VfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFk\
bWluCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIFVzZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICBtYXhsZW5ndGg6IDYzCiAgICAgICAgcmVxdWlyZWQ6IFRydWUK"

COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions

RUN yum install -y postgresql && yum clean all

USER apb
