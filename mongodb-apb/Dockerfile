FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=bmFtZTogbW9uZ29kYi1hcGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9tb25nb2RiLWFwYgpkZXNjcmlwdGlvbjogVGhpcyB0ZW1wbGF0ZSBwcm92aWRlcyBhIHN0YW5kYWxvbmUgTW9uZ29EQiBzZXJ2ZXIgd2l0aCBhIGRhdGFiYXNlIGNyZWF0ZWQuICBUaGUgZGF0YWJhc2UgaXMgc3RvcmVkIG9uIHBlcnNpc3RlbnQgc3RvcmFnZS4gIFRoZSBkYXRhYmFzZSBuYW1lLCB1c2VybmFtZSwgYW5kIHBhc3N3b3JkIGFyZSBjaG9zZW4gdmlhIHBhcmFtZXRlcnMgd2hlbiBwcm92aXNpb25pbmcgdGhpcyBzZXJ2aWNlLgpiaW5kYWJsZTogVHJ1ZQphc3luYzogdHJ1ZQptZXRhZGF0YToKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL2FjY2Vzcy5yZWRoYXQuY29tCiAgZGlzcGxheU5hbWU6IE1vbmdvREIgKFBlcnNpc3RlbnQpCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLW1vbmdvZGIKICBsb25nRGVzY3JpcHRpb246IFRoaXMgdGVtcGxhdGUgcHJvdmlkZXMgYSBzdGFuZGFsb25lIE1vbmdvREIgc2VydmVyIHdpdGggYSBkYXRhYmFzZSBjcmVhdGVkLiAgVGhlIGRhdGFiYXNlIGlzIHN0b3JlZCBvbiBwZXJzaXN0ZW50IHN0b3JhZ2UuICBUaGUgZGF0YWJhc2UgbmFtZSwgdXNlcm5hbWUsIGFuZCBwYXNzd29yZCBhcmUgY2hvc2VuIHZpYSBwYXJhbWV0ZXJzIHdoZW4gcHJvdmlzaW9uaW5nIHRoaXMgc2VydmljZS4KcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBtb25nb2RiCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERlZmF1bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95cyBNb25nb2RiCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IG1lbW9yeV9saW1pdAogICAgICAgIGRlZmF1bHQ6IDUxMk1pCiAgICAgICAgdGl0bGU6IE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0aGUgY29udGFpbmVyIGNhbiB1c2UuCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgIC0gbmFtZTogbmFtZXNwYWNlCiAgICAgICAgZGVmYXVsdDoKICAgICAgICB0aXRsZTogVGhlIE9wZW5TaGlmdCBOYW1lc3BhY2Ugd2hlcmUgdGhlIEltYWdlU3RyZWFtIHJlc2lkZXMuCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgIC0gbmFtZTogZGF0YWJhc2Vfc2VydmljZV9uYW1lCiAgICAgICAgZGVmYXVsdDogbW9uZ29kYgogICAgICAgIHRpdGxlOiBUaGUgbmFtZSBvZiB0aGUgT3BlblNoaWZ0IFNlcnZpY2UgZXhwb3NlZCBmb3IgdGhlIGRhdGFiYXNlLgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6IG1vbmdvZGJfdXNlcgogICAgICAgIGRlZmF1bHQ6IAogICAgICAgIHRpdGxlOiBVc2VybmFtZSBmb3IgTW9uZ29EQiB1c2VyIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBhY2Nlc3NpbmcgdGhlIGRhdGFiYXNlLgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6IG1vbmdvZGJfcGFzc3dvcmQKICAgICAgICBkZWZhdWx0OiAKICAgICAgICB0aXRsZTogUGFzc3dvcmQgZm9yIHRoZSBNb25nb0RCIGNvbm5lY3Rpb24gdXNlci4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgLSBuYW1lOiBtb25nb2RiX2RhdGFiYXNlCiAgICAgICAgZGVmYXVsdDogc2FtcGxlZGIKICAgICAgICB0aXRsZTogTmFtZSBvZiB0aGUgTW9uZ29EQiBkYXRhYmFzZSBhY2Nlc3NlZC4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgLSBuYW1lOiBtb25nb2RiX2FkbWluX3Bhc3N3b3JkCiAgICAgICAgZGVmYXVsdDogCiAgICAgICAgdGl0bGU6IFBhc3N3b3JkIGZvciB0aGUgZGF0YWJhc2UgYWRtaW4gdXNlci4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgLSBuYW1lOiB2b2x1bWVfY2FwYWNpdHkKICAgICAgICBkZWZhdWx0OiAxR2kKICAgICAgICB0aXRsZTogVm9sdW1lIHNwYWNlIGF2YWlsYWJsZSBmb3IgZGF0YSwgZS5nLiA1MTJNaSwgMkdpLgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6IG1vbmdvZGJfdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6IDMuMgogICAgICAgIHRpdGxlOiBWZXJzaW9uIG9mIE1vbmdvREIgaW1hZ2UgdG8gYmUgdXNlZCAoMi40LCAyLjYsIDMuMiBvciBsYXRlc3QpLgogICAgICAgIHR5cGU6IHN0cmluZwogIAo=

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
